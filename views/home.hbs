<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <style>
    body {
      background-color: #F1F2F5;
      padding-top: 10vh;
      position: relative;
    }

  nav{
    background-color: rgb(255, 255, 255);
    position: fixed !important;
    width: 100vw;
    top: 0;
    height: 10vh;
    z-index: 200;
    box-shadow: 0 1px 10px grey;

  }
  nav i{
    font-size: 2.5vmax;
    margin: 0 1vmax;
  }
  .ri-home-4-fill{
    padding-bottom: 5px;
    border-bottom: 2px solid royalblue;
    color:royalblue;
  }
  </style>
   <link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>
<body>
    <nav class="navbar navbar-expand-lg py-3 px-5">
    <div class="container">
      <a class="navbar-brand fw-bold fs-1 text-primary" href="/home">facebook</a>
    </div>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link fs-6 mx-2 my-auto" aria-current="page" href="/home"><i class="ri-home-4-fill"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link fs-6 mx-2 my-auto" href="/about"><i class="ri-bookmark-3-fill"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link fs-6 mx-2 my-auto" href="/ownProfile"><i class="ri-account-circle-fill"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link fs-6 mx-2 my-auto" href="/writePost"><i class="ri-edit-box-fill"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link fs-6 mx-2 my-auto" href="/contact"><i class="ri-contacts-book-2-fill"></i></a>
        </li>
      </ul>
    </div>
  </nav>
  <div style="position: relative;">
  <style>
    .profilePic {
      height: 40px;
      width: 40px;
      object-fit: cover;
      border-radius: 50%;
    }

    .postPic {
      object-fit: cover;
      /* scale: .7; */
      height: 100%;
      
      width: 100%;
    }
    a{
      text-decoration: none;
      color: #000;
    }
    .left{
      position: fixed;
      height: 100vh;
      width: 26vw;
      flex: 1;
      margin-top: 50px;
      background-color: #F1F2F5;
      display: flex;
      justify-content: flex-start;
      align-items: center;
    }
    .left li{
      margin: 1.3vmax 0;
      font-size: 1.2vmax;
      font-weight: 600;
      list-style: none;
    }
    .left li img{
      margin-right: 20px;
    }
    .poff{
      display: flex;
      margin-top: 20vh;
      align-items: center;
      justify-content: center;

    }
    .propif{
      height: 60px;
      border-radius: 50%;
      width: 60px;
      object-fit: cover;
    }
  </style>

  <div class="left">
    <ul>
        {{#if userData}}
      <li class="poff"><img class="propif" src="data:image/jpeg;base64,{{userData.avatar}}" alt=""> {{userData.username}}</li>
      
      <li><img src="https://img.icons8.com/color/48/null/group.png"/>Friends</li>
      <li><img src="https://img.icons8.com/color/48/null/overtime.png"/> Most Recent</li>
      <li><img src="https://img.icons8.com/color/48/null/people-skin-type-7.png"/> Groups</li>
      <li><img src="https://img.icons8.com/color/48/null/online-store.png"/>Marketplace</li>
      <li><img src="https://img.icons8.com/color/48/null/tv-show.png"/>Watch</li>
      <li><img src="https://img.icons8.com/color/48/null/clock--v4.png"/>  Memories</li>
      <li><img src="https://img.icons8.com/color/48/null/save-close--v1.png"/> Saved</li>
      <li><img src="https://img.icons8.com/color/48/null/ingredients-list.png"/>Pages</li>
      <li><img src="https://img.icons8.com/color/48/null/instagram-reel.png"/>Reels</li>
    </ul>
  </div>
  <style>
    .midle{
        position: absolute;
        left: 30%;
        margin-top: 10px;
    }
    .midle .new-status {
        max-height: fit-content;
        width: 500px;
        border: 3px  solid black;
        border-radius: 10px;
        padding: 10px;
    }
    .midle .new-status img{
      height: 30px;
      width: 30px;
      border-radius: 50%;
      object-fit: cover;
    }
    .midle .new-status input{
      height: 40px;
      width: 300px;
      border-radius: 10px;
    }
    .midle .new-status .added-image img{
      height: 100px;
        width: 100px;
        border-radius: 10px;
        object-fit: cover;
        margin: 5px;
    }
    .midle .new-status button{
      margin-left: 70%;
      margin-top: 4px;
    }
    .midle .all-status {
        width: 500px;
        height: 600px;
        border: 3px solid black;
        border-radius: 10px;
        margin-top: 10px;
    }
    .midle .all-status .inf-author{
        display: flex;
        max-height: 50px;
    }
    .avatar-author{
        width: 30px;
        height: 30px;
        border-radius: 50%;
        margin-left: 10px;
    }
    .inf-blog img{
      width: 450px;
      height: 450px;
      margin-left: 20px;
    }
  </style>
  <div class="midle">
    <div class="new-status">
      <form id="statusForm" enctype="multipart/form-data">
        <img src="data:image/jpeg;base64,{{userData.avatar}}" alt="">
        <input type="text" name="context" placeholder="Bạn đang nghĩ gì thế">
        <label for="profilePictureInput">
                <img src="status.png" alt="Profile Picture" class="profile-picture"
                    id="profilePicturePreview">
                Thêm ảnh
            </label>
            <input type="file" id="profilePictureInput" accept="image/*" style="display: none;">
            <div class="added-image" id="addedImageContainer">
            </div>
            <button type="submit" class="btn btn-primary">Đăng bài</button>
        </form>
    </div>
    {{#each blogs}}
    <div class="all-status">
        <div class="inf-author">
            <img class="avatar-author" src="data:image/jpeg;base64,{{author.avatar}}" alt="">
            <p style="margin-left: 10px;">{{author.username}}</p>
        </div>
        <div class="inf-blog">
            <p style="margin-left: 10px; font-style: italic; font-size: 10px;">Ngày Xuất Bản : {{formattedDate}}</p>
            <p style="margin-left: 10px;font-style: normal;font-size: 20px;">{{context}}</p>
            <img class="image-status" src="data:image/jpeg;base64,{{image}}" alt="Avatar">
        </div>
        </div>
        {{/each}}
  </div>
  <div class="right" style="flex: 1;">

  </div>
  </div>
  {{/if}}
  <script>
    document.getElementById('profilePictureInput').addEventListener('change', function (event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function () {
                const addedImageContainer = document.getElementById('addedImageContainer');
                const addedImage = document.createElement('img');
                addedImage.src = reader.result;
                addedImageContainer.appendChild(addedImage);
            };
            reader.readAsDataURL(file);
        }
    });
    document.getElementById('statusForm').addEventListener('submit', function (event) {
    event.preventDefault();

    const formData = new FormData();
    const imageInput = document.getElementById('profilePictureInput');
    const file = imageInput.files[0];
    const textInput = document.querySelector('input[name="context"]');
    const text = textInput.value;

    if (file) {
        formData.append('image', file);
    }

    formData.append('context', text);

    fetch('/addStatus', {
        method: 'POST',
        body: formData,
    })
    .then(response => response.text())
    .then(data => {
        alert(data); // Hiển thị thông báo từ server
        // Sau khi đăng bài thành công, có thể làm các xử lý khác nếu cần
    })
    .catch(error => console.error('Error:', error));
});

  </script>
</body>
</html>